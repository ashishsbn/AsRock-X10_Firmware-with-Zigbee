diff -Nur a/linux/include/openswan/ipsec_param2.h b/linux/include/openswan/ipsec_param2.h
--- a/linux/include/openswan/ipsec_param2.h	2014-12-05 14:02:01.056031535 -0800
+++ b/linux/include/openswan/ipsec_param2.h	2014-12-05 14:17:07.764004692 -0800
@@ -40,17 +40,17 @@
 
 /* kernels > 2.3.37-ish */
 #if defined(IP_SELECT_IDENT) && !defined(IP_SELECT_IDENT_NEW)
-#define KLIPS_IP_SELECT_IDENT(iph, skb) ip_select_ident(iph, skb_dst(skb))
+#define KLIPS_IP_SELECT_IDENT(iph, skb) __ip_select_ident(iph, 1)
 #endif
 
 /* kernels > 2.4.2 */
 #if defined(IP_SELECT_IDENT) && defined(IP_SELECT_IDENT_NEW)
-#define KLIPS_IP_SELECT_IDENT(iph, skb) ip_select_ident(iph, skb_dst(skb), NULL)
+#define KLIPS_IP_SELECT_IDENT(iph, skb) __ip_select_ident(iph, skb_dst(skb), 0)
 #endif
 
 /* kernels > 2.4.102 */
 #if defined(IP_SELECT_IDENT) && defined(IP_SELECT_IDENT_NEW2)
-#define KLIPS_IP_SELECT_IDENT(iph, skb) ip_select_ident(skb, NULL)
+#define KLIPS_IP_SELECT_IDENT(iph, skb) __ip_select_ident(skb, 1)
 #endif
 
 #endif /* SUSE_LINUX_2_4_19_IS_STUPID */
